#/bin/bash
export server_dir='unturnedserver'
export username='unt1'
export steamid='76561198067086870'
export steam_psd='skywalker1'

echo Now the user is $USER

apt update
apt install sudo -y
apt install wget -y 

# Utils
apt install screen htop unzip -y
# SteamCMD
apt install lib32stdc++6 -y
apt install mono-runtime libmono-cil-dev -y
# Unity 3D
apt install libc6 libgl1-mesa-glx libxcursor1 libxrandr2 -y
# BattleEye
apt install libc6-dev libgcc-8-dev -y

# E: Unable to locate package libgcc-8-dev

adduser $username
usermod -aG sudo $username

sudo -u $username -H sh -c "mkdir -p /home/$username/$server_dir"

cd /home/$username/$server_dir
mkdir steamcmd
cd steamcmd
wget --no-check-certificate https://steamcdn-a.akamaihd.net/client/installer/steamcmd_linux.tar.gz
tar xvf steamcmd_linux.tar.gz
rm -rf steamcmd_linux.tar.gz
chmod +x steamcmd.sh

cd /home/$username/$server_dir
wget --no-check-certificate https://github.com/RocketMod/Rocket.Unturned/releases/download/4.9.3.0/Rocket.Unturned.zip
unzip Rocket.Unturned.zip
mv Scripts/Linux/* .
chmod +x update.sh start.sh
./update.sh $steamid $steam_psd

mkdir lib
cp steamclient.so lib

su $username
./start.sh
# chmod the steamclient.so so you don't have to do what i did:
# sudo ./start.sh
# enter Y at prompt

